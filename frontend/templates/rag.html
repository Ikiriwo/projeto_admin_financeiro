{% extends "base.html" %}

{% block content %}
<div class="rag-container">
    <!-- Status Bar -->
    <div class="card rag-status-card">
        <div class="card-body">
            <div class="rag-status-bar" id="statusBar">
                <div class="status-item">
                    <span class="status-label">Status:</span>
                    <span class="status-value" id="statusValue">Carregando...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">Documentos Indexados:</span>
                    <span class="status-value" id="indexedCount">-</span>
                </div>
                <button id="indexButton" class="btn btn-success" style="display: none;">
                    Indexar Documentos
                </button>
            </div>
        </div>
    </div>

    <!-- M√©todo de Busca -->
    <div class="card">
        <div class="card-header">
            <h3>M√©todo de Busca</h3>
            <p class="subtitle">Selecione o tipo de busca que deseja utilizar</p>
        </div>
        <div class="card-body">
            <div class="method-selector">
                <label class="method-option">
                    <input type="radio" name="method" value="simple" checked>
                    <div class="method-content">
                        <div class="method-icon">üîç</div>
                        <div class="method-details">
                            <strong class="method-title">RAG Simples</strong>
                            <small class="method-description">Busca direta no banco de dados com SQL + LLM</small>
                        </div>
                    </div>
                </label>
                <label class="method-option">
                    <input type="radio" name="method" value="embeddings" id="embeddingsRadio">
                    <div class="method-content">
                        <div class="method-icon">üß†</div>
                        <div class="method-details">
                            <strong class="method-title">RAG com Embeddings</strong>
                            <small class="method-description">Busca sem√¢ntica usando vetoriza√ß√£o</small>
                        </div>
                    </div>
                </label>
            </div>
        </div>
    </div>

    <!-- Input de Pergunta -->
    <div class="card">
        <div class="card-header">
            <h3>Sua Pergunta</h3>
            <p class="subtitle">Digite sua pergunta sobre os dados financeiros</p>
        </div>
        <div class="card-body">
            <div class="rag-input-container">
                <textarea
                    id="questionInput"
                    class="rag-textarea"
                    placeholder="Digite sua pergunta aqui... Ex: Qual o total de despesas dos √∫ltimos 30 dias?"
                    rows="4"
                ></textarea>
                <button id="askButton" class="btn-primary">
                    <span class="btn-icon">ü§ñ</span>
                    Perguntar
                </button>
            </div>
        </div>
    </div>

    <!-- Exemplos -->
    <div class="card">
        <div class="card-header">
            <h3>Exemplos de Perguntas</h3>
            <p class="subtitle">Clique em um exemplo para testar</p>
        </div>
        <div class="card-body">
            <div id="examplesList" class="examples-grid">
                <div class="loading-text">Carregando exemplos...</div>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div class="rag-loading-card" id="loadingIndicator" style="display: none;">
        <div class="loading-spinner"></div>
        <p class="loading-text">Processando sua pergunta com IA...</p>
    </div>

    <!-- Resposta -->
    <div class="card rag-response-card" id="responseSection" style="display: none;">
        <div class="card-header">
            <h3>Resposta</h3>
            <span class="response-method-badge" id="responseMethod"></span>
        </div>
        <div class="card-body">
            <div class="response-content" id="responseContent">
                <!-- Resposta ser√° inserida aqui -->
            </div>
            <div class="response-metadata" id="responseMetadata" style="display: none;">
                <details>
                    <summary>Detalhes T√©cnicos</summary>
                    <pre id="metadataContent"></pre>
                </details>
            </div>
        </div>
    </div>

    <!-- Error -->
    <div class="rag-error-card" id="errorSection" style="display: none;">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-message" id="errorMessage"></div>
    </div>
</div>

<script src="{{ url_for('static', filename='js/rag.js') }}"></script>
{% endblock %}
